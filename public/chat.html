<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Travel Planner</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Poppins',sans-serif;
}

body{
    height:100vh;
    overflow:hidden;
    color:white;
    background:#000;
}

/* ================= BACKGROUND ================= */

/* Background Layers */
.bg-layer {
    position: fixed;
    width: 110%;
    height: 110%;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transition: opacity 1.6s ease, transform 0.2s linear;
    animation: zoom 35s infinite alternate ease-in-out;
    transform: scale(1.08); /* IMPORTANT */
}

.bg1{ z-index:-4; opacity:1; }
.bg2{ z-index:-5; opacity:0; }

@keyframes zoom{
    from{ transform:scale(1); }
    to{ transform:scale(1.08); }
}

/* Cinematic overlay */
.overlay{
    position:fixed;
    width:100%;
    height:100%;
    background:
        radial-gradient(circle at 50% 60%, rgba(0,0,0,0.2), rgba(0,0,0,0.85)),
        linear-gradient(135deg, rgba(0,0,0,0.5), rgba(0,0,0,0.7));
    z-index:-3;
    transition:background 1s ease;
}

/* ================= AI ORB ================= */

.ai-orb{
    position:absolute;
    top:90px;
    left:50%;
    transform:translateX(-50%);
    width:90px;
    height:90px;
    border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #00eaff, #0066ff);
    box-shadow:
        0 0 25px rgba(0,200,255,0.8),
        0 0 60px rgba(0,120,255,0.5);
    animation:orbFloat 4s ease-in-out infinite;
}

@keyframes orbFloat{
    0%,100%{ transform:translate(-50%,0px); }
    50%{ transform:translate(-50%,-12px); }
}

/* ================= HEADER ================= */

.header{
    position:absolute;
    top:30px;
    left:50%;
    transform:translateX(-50%);
    font-size:34px;
    font-weight:800;
    letter-spacing:3px;
    text-shadow:0 10px 30px rgba(0,0,0,0.8);
}

/* ================= CHAT ================= */

.chat-container{
    position:absolute;
    bottom:40px;
    left:50%;
    transform:translateX(-50%);
    width:92%;
    max-width:950px;
    height:72vh;
    backdrop-filter:blur(30px);
    background:rgba(255,255,255,0.08);
    border-radius:28px;
    display:flex;
    flex-direction:column;
    padding:25px;
    box-shadow:0 40px 120px rgba(0,0,0,0.7);
}

.chat-box{
    flex:1;
    overflow-y:auto;
    padding:10px;
}

.message{
    margin-bottom:18px;
    padding:15px 20px;
    border-radius:22px;
    max-width:75%;
    animation:slideUp .35s ease forwards;
    white-space:pre-line;
    line-height:1.5;
}

.user{
    background:linear-gradient(45deg,#00eaff,#0072ff);
    align-self:flex-end;
}

.ai{
    background:rgba(255,255,255,0.14);
    align-self:flex-start;
}

@keyframes slideUp{
    from{ opacity:0; transform:translateY(20px); }
    to{ opacity:1; transform:translateY(0); }
}

/* ================= INPUT ================= */

.input-area{
    display:flex;
    gap:12px;
}

input{
    flex:1;
    padding:16px;
    border-radius:18px;
    border:none;
    outline:none;
    font-size:15px;
}

button{
    padding:16px 28px;
    border-radius:18px;
    border:none;
    cursor:pointer;
    font-weight:600;
    background:linear-gradient(45deg,#00c6ff,#0072ff);
    color:white;
    transition:.25s;
}

button:hover{
    transform:scale(1.06);
}

.typing{
    opacity:.7;
    font-style:italic;
}
</style>
</head>

<body>

<div class="bg-layer bg1" id="bg1"></div>
<div class="bg-layer bg2" id="bg2"></div>
<div class="overlay" id="overlay"></div>

<div class="header">âœˆ AI Travel Planner</div>
<div class="ai-orb"></div>

<div class="chat-container">
    <div class="chat-box" id="chatBox"></div>

    <div class="input-area">
        <input type="text" id="userInput" placeholder="Describe your dream journey..." />
        <button onclick="sendMessage()">Explore</button>
    </div>
</div>

<script>
    
const chatBox=document.getElementById("chatBox");
const input=document.getElementById("userInput");
const bg1=document.getElementById("bg1");
const bg2=document.getElementById("bg2");
const overlay=document.getElementById("overlay");

let activeBg=bg1;
let inactiveBg=bg2;

// DEFAULT BACKGROUND (so never black)
bg1.style.backgroundImage =
"url('https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1920&q=80')";

/* ===== SMOOTH BACKGROUND ===== */
function changeBackground(place){

    const url =
    `https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1920&q=80&sig=${Math.random()}&${place}`;

    const img = new Image();

    img.onload = function(){
        inactiveBg.style.backgroundImage = `url(${url})`;
        inactiveBg.style.opacity = 1;

        setTimeout(()=>{
            activeBg.style.opacity = 0;
            [activeBg,inactiveBg] = [inactiveBg,activeBg];
        },120);
    };

    img.onerror = function(){
        console.log("Image failed, keeping previous background");
    };

    img.src = url;

    applyTemperatureOverlay(place);
}

/* ===== WARM / COLD ===== */
function applyTemperatureOverlay(place){
    const warm=["egypt","dubai","africa","morocco","goa","bali","maldives"];
    const cold=["switzerland","canada","iceland","finland","norway","kashmir"];

    place=place.toLowerCase();

    if(warm.some(p=>place.includes(p))){
        overlay.style.background=
        "radial-gradient(circle at 50% 60%, rgba(255,120,0,0.25), rgba(0,0,0,0.9))";
    }
    else if(cold.some(p=>place.includes(p))){
        overlay.style.background=
        "radial-gradient(circle at 50% 60%, rgba(0,120,255,0.25), rgba(0,0,0,0.9))";
    }
    else{
        overlay.style.background=
        "radial-gradient(circle at 50% 60%, rgba(0,0,0,0.2), rgba(0,0,0,0.9))";
    }
}

/* ===== PARALLAX MOUSE ===== */
document.addEventListener("mousemove",(e)=>{

    const x = (e.clientX / window.innerWidth - 0.5) * 40;
    const y = (e.clientY / window.innerHeight - 0.5) * 40;

    activeBg.style.transform =
        `translate(${x}px, ${y}px) scale(1.08)`;
});

/* ===== CHAT ===== */
function addMessage(text,className){
    const div=document.createElement("div");
    div.className="message "+className;
    div.innerText=text;
    chatBox.appendChild(div);
    chatBox.scrollTop=chatBox.scrollHeight;
}

async function sendMessage(){
    const message=input.value;
    if(!message) return;

    addMessage(message,"user");

    const words=message.trim().split(" ");
    changeBackground(words[words.length-1]);

    input.value="";

    const typingDiv=document.createElement("div");
    typingDiv.className="message ai typing";
    typingDiv.innerText="AI is planning your cinematic journey...";
    chatBox.appendChild(typingDiv);

    const response=await fetch("/ai-chat",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({ message })
    });

    const data=await response.json();
    chatBox.removeChild(typingDiv);

    addMessage(data.reply,"ai");
}
</script>

</body>
</html>